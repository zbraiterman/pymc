
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Probability Distributions in PyMC3 &#8212; PyMC3 3.10.0 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/semantic-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/default.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="_static/highlight.min.js"></script>
    <script src="_static/semantic.min.js"></script>
    <link rel="shortcut icon" href="_static/PyMC3.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-176578023-1']);
  _gaq.push(['_trackPageview']);
</script>
<script>hljs.initHighlightingOnLoad();</script>
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">



  </head><body>
<div class="ui vertical center aligned">

    <div class="ui container">
        <div class="ui large secondary pointing menu">
            <a class="item" href="/">
                <img class="ui bottom aligned tiny image" src="https://cdn.rawgit.com/pymc-devs/pymc3/master/docs/logos/svg/PyMC3_banner.svg" />
            </a>
             <a href="nb_tutorials/index.html" class="item">Tutorials</a> <a href="nb_examples/index.html" class="item">Examples</a> <a href="learn.html" class="item">Books + Videos</a> <a href="api.html" class="item">API</a> <a href="developer_guide.html" class="item">Developer Guide</a> <a href="about.html" class="item">About PyMC3</a>
            
            <div class="right menu">
                <div class="item">
                    <form class="ui icon input" action="search.html" method="get">
                        <input type="text" placeholder="Search..." name="q" />
                        <i class="search link icon"></i>
                    </form>
                </div>
                <a class="item" href="https://github.com/pymc-devs/pymc3"><i class="github blue icon large"></i></a>
            </div>
        </div>
    </div>
    
</div>

<div class="ui container" role="main">
    

    <div class="ui vertical segment">
        
  <div class="section" id="probability-distributions-in-pymc3">
<span id="prob-dists"></span><h1>Probability Distributions in PyMC3<a class="headerlink" href="#probability-distributions-in-pymc3" title="Permalink to this headline">¶</a></h1>
<p>The most fundamental step in building Bayesian models is the specification of a full probability model for the problem at hand. This primarily involves assigning parametric statistical distributions to unknown quantities in the model, in addition to appropriate functional forms for likelihoods to represent the information from the data. To this end, PyMC3 includes a comprehensive set of pre-defined statistical distributions that can be used as model building blocks.</p>
<p>For example, if we wish to define a particular variable as having a normal prior, we can specify that using an instance of the <code class="docutils literal notranslate"><span class="pre">Normal</span></code> class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">():</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>A variable requires at least a <code class="docutils literal notranslate"><span class="pre">name</span></code> argument, and zero or more model parameters, depending on the distribution. Parameter names vary by distribution, using conventional names wherever possible. The example above defines a scalar variable. To make a vector-valued variable, a <code class="docutils literal notranslate"><span class="pre">shape</span></code> argument should be provided; for example, a 3x3 matrix of beta random variables could be defined with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">():</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>Probability distributions are all subclasses of <code class="docutils literal notranslate"><span class="pre">Distribution</span></code>, which in turn has two major subclasses: <code class="docutils literal notranslate"><span class="pre">Discrete</span></code> and <code class="docutils literal notranslate"><span class="pre">Continuous</span></code>. In terms of data types, a <code class="docutils literal notranslate"><span class="pre">Continuous</span></code> random variable is given whichever floating point type is defined by <code class="docutils literal notranslate"><span class="pre">theano.config.floatX</span></code>, while <code class="docutils literal notranslate"><span class="pre">Discrete</span></code> variables are given <code class="docutils literal notranslate"><span class="pre">int16</span></code> types when <code class="docutils literal notranslate"><span class="pre">theano.config.floatX</span></code> is <code class="docutils literal notranslate"><span class="pre">float32</span></code>, and <code class="docutils literal notranslate"><span class="pre">int64</span></code> otherwise.</p>
<p>All distributions in <code class="docutils literal notranslate"><span class="pre">pm.distributions</span></code> will have two important methods: <code class="docutils literal notranslate"><span class="pre">random()</span></code> and <code class="docutils literal notranslate"><span class="pre">logp()</span></code> with the following signatures:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SomeDistribution</span><span class="p">(</span><span class="n">Continuous</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="n">random_samples</span>

    <span class="k">def</span> <span class="nf">logp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="n">total_log_prob</span>
</pre></div>
</div>
<p>PyMC3 expects the <code class="docutils literal notranslate"><span class="pre">logp()</span></code> method to return a log-probability evaluated at the passed <code class="docutils literal notranslate"><span class="pre">value</span></code> argument. This method is used internally by all of the inference methods to calculate the model log-probability that is used for fitting models. The <code class="docutils literal notranslate"><span class="pre">random()</span></code> method is used to simulate values from the variable, and is used internally for posterior predictive checks.</p>
<div class="section" id="custom-distributions">
<h2>Custom distributions<a class="headerlink" href="#custom-distributions" title="Permalink to this headline">¶</a></h2>
<p>Despite the fact that PyMC3 ships with a large set of the most common probability distributions, some problems may require the use of functional forms that are less common, and not available in <code class="docutils literal notranslate"><span class="pre">pm.distributions</span></code>. One example of this is in survival analysis, where time-to-event data is modeled using probability densities that are designed to accommodate censored data.</p>
<p>An exponential survival function, where <span class="math notranslate nohighlight">\(c=0\)</span> denotes failure (or non-survival), is defined by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(c, t) = \left\{ \begin{array}{l} \exp(-\lambda t), \text{if c=1} \\
           \lambda \exp(-\lambda t), \text{if c=0}  \end{array} \right.\end{split}\]</div>
<p>Such a function can be implemented as a PyMC3 distribution by writing a function that specifies the log-probability, then passing that function as an argument to the <code class="docutils literal notranslate"><span class="pre">DensityDist</span></code> function, which creates an instance of a PyMC3 distribution with the custom function as its log-probability.</p>
<p>For the exponential survival function, this is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logp</span><span class="p">(</span><span class="n">failure</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">failure</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">λ</span><span class="p">)</span> <span class="o">-</span> <span class="n">λ</span> <span class="o">*</span> <span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">exp_surv</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">DensityDist</span><span class="p">(</span><span class="s1">&#39;exp_surv&#39;</span><span class="p">,</span> <span class="n">logp</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;failure&#39;</span><span class="p">:</span><span class="n">failure</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="n">t</span><span class="p">})</span>
</pre></div>
</div>
<p>Similarly, if a random number generator is required, a function returning random numbers corresponding to the probability distribution can be passed as the <code class="docutils literal notranslate"><span class="pre">random</span></code> argument.</p>
</div>
<div class="section" id="using-pymc-distributions-without-a-model">
<h2>Using PyMC distributions without a Model<a class="headerlink" href="#using-pymc-distributions-without-a-model" title="Permalink to this headline">¶</a></h2>
<p>Distribution objects, as we have defined them so far, are only usable inside of a <code class="docutils literal notranslate"><span class="pre">Model</span></code> context. If they are created outside of the model context manager, it raises an error.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">Binomial</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">TypeError</span><span class="p">:</span> <span class="n">No</span> <span class="n">context</span> <span class="n">on</span> <span class="n">context</span> <span class="n">stack</span>
</pre></div>
</div>
<p>This is because the distribution classes are designed to integrate themselves automatically inside of a PyMC model. When a model cannot be found, it fails. However, each <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> has a <code class="docutils literal notranslate"><span class="pre">dist</span></code> class method that returns a stripped-down distribution object that can be used outside of a PyMC model.</p>
<p>For example, a standalone binomial distribution can be created by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Binomial</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>This allows for probabilities to be calculated and random numbers to be drawn.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">logp</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array(-1.5843639373779297, dtype=float32)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([5, 4, 3])</span>
</pre></div>
</div>
</div>
<div class="section" id="auto-transformation">
<h2>Auto-transformation<a class="headerlink" href="#auto-transformation" title="Permalink to this headline">¶</a></h2>
<p>To aid efficient MCMC sampling, any continuous variables that are constrained to a sub-interval of the real line are automatically transformed so that their support is unconstrained. This frees sampling algorithms from having to deal with boundary constraints.</p>
<p>For example, the gamma distribution is positive-valued. If we define one for a model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Gamma</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>We notice a modified variable inside the model <code class="docutils literal notranslate"><span class="pre">vars</span></code> attribute, which holds the free variables in the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">vars</span>
<span class="go">[g_log__]</span>
</pre></div>
</div>
<p>As the name suggests, the variable <code class="docutils literal notranslate"><span class="pre">g</span></code> has been log-transformed, and this is the space over which sampling takes place.</p>
<p>The original variable is simply treated as a deterministic variable, since the value of the transformed variable is simply back-transformed when a sample is drawn in order to recover the original variable. Hence, <code class="docutils literal notranslate"><span class="pre">g</span></code> resides in the <code class="docutils literal notranslate"><span class="pre">model.deterministics</span></code> list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">deterministics</span>
<span class="go">[g]</span>
</pre></div>
</div>
<p>By default, auto-transformed variables are ignored when summarizing and plotting model output.</p>
</div>
</div>


    </div>
</div>
<div class="ui vertical footer segment">
    <div class="ui center aligned container">
        <a href="https://github.com/pymc-devs/pymc3"><i class="github icon large"></i></a>
        <a href="https://twitter.com/pymc_devs"><i class="twitter icon large"></i></a>
        <a href="https://discourse.pymc.io/"><i class="discourse icon large"></i></a>
    </div>
    <div class="ui center aligned container">This page uses <a href="https://analytics.google.com/">
    Google Analytics</a> to collect statistics. You can disable it by blocking
    the JavaScript coming from www.google-analytics.com.
    <script>
      (function() {
        var ga = document.createElement('script');
        ga.src = ('https:' == document.location.protocol ?
                  'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        ga.setAttribute('async', 'true');
        document.documentElement.firstChild.appendChild(ga);
      })();
    </script>
    </div>
    <div class="ui center aligned container">
        <p>
            &copy; Copyright 2018, The PyMC Development Team.
        </p>
        <p>
            Created using <a href="https://sphinx-doc.org/">Sphinx</a> 3.4.0.<br />
        </p>
    </div>
</div>
  </body>
</html>